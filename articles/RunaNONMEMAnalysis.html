<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Run a NONMEM Analysis • qpToolkit</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Run a NONMEM Analysis">
<meta property="og:description" content="qpToolkit">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">qpToolkit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ASeriesofqpToolkitVignettes.html">qpToolkit Vignettes</a>
    </li>
    <li>
      <a href="../articles/CreateDemographicsTable.html">Creating a Demographics Table</a>
    </li>
    <li>
      <a href="../articles/ExamplesnlmexxxFunctionsqpToolkit.html">qpToolkit Examples for nlme_xxx Functions</a>
    </li>
    <li>
      <a href="../articles/ExamplesnmxxxFunctionsqpToolkit.html">qpToolkit Examples for nm_xxx Functions</a>
    </li>
    <li>
      <a href="../articles/RunaNONMEMAnalysis.html">Run a NONMEM Analysis</a>
    </li>
    <li>
      <a href="../articles/qPColorPalette.html">qPharmetra Color Palette</a>
    </li>
    <li>
      <a href="../articles/qpToolkitGeneralPurposeFunctions.html">qpToolkit General Purpose Functions</a>
    </li>
    <li>
      <a href="../articles/qpToolkitPKPDpredictionFunctions.html">qpToolkit PKPD Prediction Functions</a>
    </li>
    <li>
      <a href="../articles/qpToolkitPlottingTips.html">qpToolkit Plotting Tips</a>
    </li>
    <li>
      <a href="../articles/qpToolkitgetFunctions.html">qpToolkit get_xxx Functions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Run a NONMEM Analysis</h1>
                        <h4 class="author">Klaas Prins &amp; Jason Chittenden</h4>
            
            <h4 class="date">2020-05-11</h4>
      
      
      <div class="hidden name"><code>RunaNONMEMAnalysis.Rmd</code></div>

    </div>

    
    
<p>This is an analysis notebook template/example using RMarkdown. This analysis uses examples from the NONMEM examples folder in a couple model development steps. Example 1 is a base model, example2 is the known covariate model (i.e. it was apparently simulated). The base model is reconfigured and run through PSN::SCM and the final model is rerun as example 3. This analysis notebook template demonstrates a few key features of Rmarkdown and the qpToolkit functionality:</p>
<ul>
<li>Production of an analysis document containing text, tables and plots.</li>
<li>Accessing NONMEM run data in qp formatting folders</li>
<li>Using a ‘child’ rmd file to run commonly repeated tasks like:
<ul>
<li>Printing parameter tables</li>
<li>Making GOF and diagnostic plots</li>
</ul>
</li>
<li>Data and model exploration steps</li>
<li>Model validation</li>
</ul>
<p>Note that a TOC with two levels is requested, so h2 and h3 headers (with two or three hashes) will be presented. One suggestions is to start each major analysis step with an h2 header, and place subsequent major sections in h3 headers.</p>
<p>A key feature of this template is the use of a subreport to show model results. Within a given project, it is assumed that one would like to review model results in a consistent manner (same plots, tables, etc.). The sub report eliminates repetitious coding of these features.</p>
<p>IMPORTANT NOTE: Be sure to place your copy of /utils and drive.r in the project folder. These are not included in order to save space.</p>
<div id="dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#dataset" class="anchor"></a>Dataset</h2>
<p>The dataset used in this study is the example1.csv from the NONMEM examples. The example2.csv dataset is the same but has the covariates added.</p>
<div id="exploratory-data-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#exploratory-data-analysis" class="anchor"></a>Exploratory Data Analysis</h3>
<div id="spaghetti-plot" class="section level4">
<h4 class="hasAnchor">
<a href="#spaghetti-plot" class="anchor"></a>Spaghetti Plot</h4>
<p>It make make sense to stratify the plots by dose, day, cycle, etc…</p>
<p><img src="RunaNONMEMAnalysis_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div id="with-smoother-on-mean" class="section level5">
<h5 class="hasAnchor">
<a href="#with-smoother-on-mean" class="anchor"></a>With smoother on mean</h5>
<p><img src="RunaNONMEMAnalysis_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
</div>
<div id="covariate-correlations" class="section level4">
<h4 class="hasAnchor">
<a href="#covariate-correlations" class="anchor"></a>Covariate Correlations</h4>
<p>If you have the GGally package, enable the code in this section.</p>
<pre><code>## Registered S3 method overwritten by 'GGally':
##   method from   
##   +.gg   ggplot2</code></pre>
<pre><code>## 
## Attaching package: 'GGally'</code></pre>
<pre><code>## The following object is masked from 'package:dplyr':
## 
##     nasa</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: Formula</code></pre>
<pre><code>## 
## Attaching package: 'Hmisc'</code></pre>
<pre><code>## The following objects are masked from 'package:dplyr':
## 
##     src, summarize</code></pre>
<pre><code>## The following objects are masked from 'package:plyr':
## 
##     is.discrete, summarize</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     format.pval, units</code></pre>
<pre><code>## Warning in check_and_set_ggpairs_defaults("diag", diag, continuous =
## "densityDiag", : Changing diag$continuous from 'density' to 'densityDiag'</code></pre>
<pre><code>## Warning in check_and_set_ggpairs_defaults("diag", diag, continuous =
## "densityDiag", : Changing diag$discrete from 'bar' to 'barDiag'</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="RunaNONMEMAnalysis_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
</div>
</div>
<div id="structural-models" class="section level2">
<h2 class="hasAnchor">
<a href="#structural-models" class="anchor"></a>Structural models</h2>
<p>This shows how to pick up runrecord information. When using PSN::runrecord be sure to set -max_lvl=0.</p>
<div id="run-directory-comparison" class="section level3">
<h3 class="hasAnchor">
<a href="#run-directory-comparison" class="anchor"></a>Run Directory Comparison</h3>
<table class="table">
<thead><tr class="header">
<th align="right">Run</th>
<th align="left">Ref</th>
<th align="right">OFV</th>
<th align="left">dOFV</th>
<th align="left">CondNum</th>
<th align="left">Minimization</th>
<th align="left">Description</th>
<th align="left">action</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">0</td>
<td align="right">-1121.0</td>
<td align="left">NA</td>
<td align="left">27</td>
<td align="left">Successful</td>
<td align="left">2 compartment model</td>
<td align="left">~</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">1</td>
<td align="right">-10772.1</td>
<td align="left">-9651.1</td>
<td align="left">158</td>
<td align="left">Successful</td>
<td align="left">Covariate Model CL and V with Gender and Age</td>
<td align="left">accepted</td>
</tr>
</tbody>
</table>
<p>One compartment is clearly sufficient.</p>
</div>
<div id="example-1-base-model" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1-base-model" class="anchor"></a>Example 1: Base Model</h3>
<p>This starts a subreport on run: example 1 <img src="RunaNONMEMAnalysis_files/figure-html/unnamed-chunk-7-1.png" width="700"><img src="RunaNONMEMAnalysis_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
<p>Write some notes about the GOF here. You can use the text in presentations or reports.</p>
</div>
</div>
<div id="covariate-modeling" class="section level2">
<h2 class="hasAnchor">
<a href="#covariate-modeling" class="anchor"></a>Covariate modeling</h2>
<div id="covariate-signals" class="section level3">
<h3 class="hasAnchor">
<a href="#covariate-signals" class="anchor"></a>Covariate Signals</h3>
<p>nm.covplot explores post-hoc fits vs covariates.</p>
<pre><code>## Joining, by = "Parameter"</code></pre>
<pre><code>## processed NONMEM output and covariate data and created covariate plots of 400 subjects</code></pre>
<p><img src="RunaNONMEMAnalysis_files/figure-html/covSignals-1.png" width="700"><img src="RunaNONMEMAnalysis_files/figure-html/covSignals-2.png" width="700"></p>
</div>
<div id="eta-covariate-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#eta-covariate-plots" class="anchor"></a>Eta covariate plots</h3>
<p>The covariate plots can also be made for etas, to detect bias.</p>
<p><img src="RunaNONMEMAnalysis_files/figure-html/unnamed-chunk-8-1.png" width="700"><img src="RunaNONMEMAnalysis_files/figure-html/unnamed-chunk-8-2.png" width="700"><img src="RunaNONMEMAnalysis_files/figure-html/unnamed-chunk-8-3.png" width="700"><img src="RunaNONMEMAnalysis_files/figure-html/unnamed-chunk-8-4.png" width="700"></p>
</div>
<div id="scm-model-building" class="section level3">
<h3 class="hasAnchor">
<a href="#scm-model-building" class="anchor"></a>SCM Model Building</h3>
<p>Print the steps in the process. Here we grab the results and format them for markdown.</p>
<div id="summary-of-steps" class="section level4">
<h4 class="hasAnchor">
<a href="#summary-of-steps" class="anchor"></a>Summary of Steps</h4>
<table class="table">
<thead><tr class="header">
<th align="right">Step</th>
<th align="left">Model</th>
<th align="left">Search Type</th>
<th align="right">Test P-value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">CLGNDR-2</td>
<td align="left">Addition</td>
<td align="right">0.0e+00</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">CLAGE-5</td>
<td align="left">Addition</td>
<td align="right">0.0e+00</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">V1AGE-5</td>
<td align="left">Addition</td>
<td align="right">0.0e+00</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">V1GNDR-2</td>
<td align="left">Addition</td>
<td align="right">1.2e-05</td>
</tr>
</tbody>
</table>
</div>
<div id="model-building-steps" class="section level4">
<h4 class="hasAnchor">
<a href="#model-building-steps" class="anchor"></a>Model Building Steps</h4>
<table class="table">
<thead><tr class="header">
<th align="right">Step</th>
<th align="left">Model</th>
<th align="right">Base Objective Function Value</th>
<th align="right">Test Objective Function Value</th>
<th align="right">Delta Objective Function Value</th>
<th align="right">Reference Delta Objective Function Value</th>
<th align="right">Delta Degrees of Freedom</th>
<th align="left">Significant</th>
<th align="right">Test P-value</th>
<th align="left">Effect Was Selected</th>
<th align="left">Search Type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">CLAGE-5</td>
<td align="right">-5494.546</td>
<td align="right">-8791.872</td>
<td align="right">3297.32607</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">yes</td>
<td align="right">0.0000000</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">CLGNDR-2</td>
<td align="right">-5494.546</td>
<td align="right">-9557.268</td>
<td align="right">4062.72165</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">yes</td>
<td align="right">0.0000000</td>
<td align="left">yes</td>
<td align="left">Addition</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">QAGE-5</td>
<td align="right">-5494.546</td>
<td align="right">-6123.028</td>
<td align="right">628.48146</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">yes</td>
<td align="right">0.0000000</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">QGNDR-2</td>
<td align="right">-5494.546</td>
<td align="right">-8789.924</td>
<td align="right">3295.37813</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">yes</td>
<td align="right">0.0000000</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">V1AGE-5</td>
<td align="right">-5494.546</td>
<td align="right">-9145.808</td>
<td align="right">3651.26194</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">yes</td>
<td align="right">0.0000000</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">V1GNDR-2</td>
<td align="right">-5494.546</td>
<td align="right">-9049.804</td>
<td align="right">3555.25789</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">yes</td>
<td align="right">0.0000000</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">V2AGE-5</td>
<td align="right">-5494.546</td>
<td align="right">-8810.115</td>
<td align="right">3315.56884</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">yes</td>
<td align="right">0.0000000</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">V2GNDR-2</td>
<td align="right">-5494.546</td>
<td align="right">-8790.222</td>
<td align="right">3295.67624</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">yes</td>
<td align="right">0.0000000</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">CLAGE-5</td>
<td align="right">-9557.268</td>
<td align="right">-9746.452</td>
<td align="right">189.18389</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">yes</td>
<td align="right">0.0000000</td>
<td align="left">yes</td>
<td align="left">Addition</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">QAGE-5</td>
<td align="right">-9557.268</td>
<td align="right">-9560.038</td>
<td align="right">2.77025</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">no</td>
<td align="right">0.0960310</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">QGNDR-2</td>
<td align="right">-9557.268</td>
<td align="right">-9559.482</td>
<td align="right">2.21381</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">no</td>
<td align="right">0.1367800</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">V1AGE-5</td>
<td align="right">-9557.268</td>
<td align="right">-9658.181</td>
<td align="right">100.91305</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">yes</td>
<td align="right">0.0000000</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">V1GNDR-2</td>
<td align="right">-9557.268</td>
<td align="right">-9565.896</td>
<td align="right">8.62816</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">yes</td>
<td align="right">0.0033100</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">V2AGE-5</td>
<td align="right">-9557.268</td>
<td align="right">-9570.108</td>
<td align="right">12.84003</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">yes</td>
<td align="right">0.0003390</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">V2GNDR-2</td>
<td align="right">-9557.268</td>
<td align="right">-9557.272</td>
<td align="right">0.00373</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">no</td>
<td align="right">0.9513000</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">QAGE-5</td>
<td align="right">-9746.452</td>
<td align="right">-9746.702</td>
<td align="right">0.25034</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">no</td>
<td align="right">0.6168400</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">QGNDR-2</td>
<td align="right">-9746.452</td>
<td align="right">-9748.516</td>
<td align="right">2.06474</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">no</td>
<td align="right">0.1507400</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">V1AGE-5</td>
<td align="right">-9746.452</td>
<td align="right">-10176.099</td>
<td align="right">429.64766</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">yes</td>
<td align="right">0.0000000</td>
<td align="left">yes</td>
<td align="left">Addition</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">V1GNDR-2</td>
<td align="right">-9746.452</td>
<td align="right">-9752.874</td>
<td align="right">6.42272</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">no</td>
<td align="right">0.0112670</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">V2AGE-5</td>
<td align="right">-9746.452</td>
<td align="right">-9771.672</td>
<td align="right">25.22079</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">yes</td>
<td align="right">0.0000010</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">V2GNDR-2</td>
<td align="right">-9746.452</td>
<td align="right">-9746.473</td>
<td align="right">0.02120</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">no</td>
<td align="right">0.8842200</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">QAGE-5</td>
<td align="right">-10176.099</td>
<td align="right">-10176.100</td>
<td align="right">0.00089</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">no</td>
<td align="right">0.9761800</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">QGNDR-2</td>
<td align="right">-10176.099</td>
<td align="right">-10177.775</td>
<td align="right">1.67521</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">no</td>
<td align="right">0.1955600</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">V1GNDR-2</td>
<td align="right">-10176.099</td>
<td align="right">-10195.277</td>
<td align="right">19.17797</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">yes</td>
<td align="right">0.0000120</td>
<td align="left">yes</td>
<td align="left">Addition</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">V2AGE-5</td>
<td align="right">-10176.099</td>
<td align="right">-10176.874</td>
<td align="right">0.77419</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">no</td>
<td align="right">0.3789200</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">V2GNDR-2</td>
<td align="right">-10176.099</td>
<td align="right">-10176.230</td>
<td align="right">0.13045</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">no</td>
<td align="right">0.7179600</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">QAGE-5</td>
<td align="right">-10195.277</td>
<td align="right">-10195.280</td>
<td align="right">0.00280</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">no</td>
<td align="right">0.9577800</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">QGNDR-2</td>
<td align="right">-10195.277</td>
<td align="right">-10197.794</td>
<td align="right">2.51704</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">no</td>
<td align="right">0.1126200</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">V2AGE-5</td>
<td align="right">-10195.277</td>
<td align="right">-10195.878</td>
<td align="right">0.60062</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">no</td>
<td align="right">0.4383400</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">V2GNDR-2</td>
<td align="right">-10195.277</td>
<td align="right">-10195.824</td>
<td align="right">0.54635</td>
<td align="right">6.6349</td>
<td align="right">1</td>
<td align="left">no</td>
<td align="right">0.4598100</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="left">CLAGE-1</td>
<td align="right">-10195.277</td>
<td align="right">-9671.863</td>
<td align="right">-523.41471</td>
<td align="right">-10.8280</td>
<td align="right">-1</td>
<td align="left">no</td>
<td align="right">0.0000000</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">CLGNDR-1</td>
<td align="right">-10195.277</td>
<td align="right">-9250.324</td>
<td align="right">-944.95348</td>
<td align="right">-10.8280</td>
<td align="right">-1</td>
<td align="left">no</td>
<td align="right">0.0000000</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="left">V1AGE-1</td>
<td align="right">-10195.277</td>
<td align="right">-9752.874</td>
<td align="right">-442.40292</td>
<td align="right">-10.8280</td>
<td align="right">-1</td>
<td align="left">no</td>
<td align="right">0.0000000</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">V1GNDR-1</td>
<td align="right">-10195.277</td>
<td align="right">-10169.003</td>
<td align="right">-26.27446</td>
<td align="right">-10.8280</td>
<td align="right">-1</td>
<td align="left">no</td>
<td align="right">0.0000003</td>
<td align="left">no</td>
<td align="left">Addition</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="final-model" class="section level2">
<h2 class="hasAnchor">
<a href="#final-model" class="anchor"></a>Final Model</h2>
<p><img src="RunaNONMEMAnalysis_files/figure-html/unnamed-chunk-10-1.png" width="700"><img src="RunaNONMEMAnalysis_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
<div id="parameter-estimates" class="section level3">
<h3 class="hasAnchor">
<a href="#parameter-estimates" class="anchor"></a>Parameter estimates</h3>
<p>These should come from parTab, converted to a list or even just the estimates transposed. ETAs need to be inserted as zeros. Need to add a utility function for this.</p>
<pre><code>## Joining, by = "Parameter"</code></pre>
<table class="table">
<thead><tr class="header">
<th align="left">Parameter</th>
<th align="right">Estimate</th>
<th align="left">CV.perc</th>
<th align="left">SE</th>
<th align="left">estimated</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">THETA1</td>
<td align="right">11.9863000</td>
<td align="left">1.48124942642851</td>
<td align="left">0.177547</td>
<td align="left">estimated</td>
</tr>
<tr class="even">
<td align="left">THETA2</td>
<td align="right">6.2384800</td>
<td align="left">1.13134609712622</td>
<td align="left">0.0705788</td>
<td align="left">estimated</td>
</tr>
<tr class="odd">
<td align="left">THETA3</td>
<td align="right">2.0008100</td>
<td align="left">1.06321939614456</td>
<td align="left">0.021273</td>
<td align="left">estimated</td>
</tr>
<tr class="even">
<td align="left">THETA4</td>
<td align="right">10.0002000</td>
<td align="left">0.86382472350553</td>
<td align="left">0.0863842</td>
<td align="left">estimated</td>
</tr>
<tr class="odd">
<td align="left">THETA5</td>
<td align="right">0.1002390</td>
<td align="left">2.84841229461587</td>
<td align="left">0.00285522</td>
<td align="left">estimated</td>
</tr>
<tr class="even">
<td align="left">THETA6</td>
<td align="right">-0.3824870</td>
<td align="left">-3.10083741408205</td>
<td align="left">0.0118603</td>
<td align="left">estimated</td>
</tr>
<tr class="odd">
<td align="left">THETA7</td>
<td align="right">-0.7233300</td>
<td align="left">-0.802036414914355</td>
<td align="left">0.00580137</td>
<td align="left">estimated</td>
</tr>
<tr class="even">
<td align="left">THETA8</td>
<td align="right">0.2526630</td>
<td align="left">3.40085014426331</td>
<td align="left">0.00859269</td>
<td align="left">estimated</td>
</tr>
<tr class="odd">
<td align="left">THETA9</td>
<td align="right">0.0719913</td>
<td align="left">23.3176786639497</td>
<td align="left">0.0167867</td>
<td align="left">estimated</td>
</tr>
<tr class="even">
<td align="left">OMEGA1.1</td>
<td align="right">0.0412289</td>
<td align="left">7.86346470558273</td>
<td align="left">0.00324202</td>
<td align="left">estimated</td>
</tr>
<tr class="odd">
<td align="left">OMEGA2.1</td>
<td align="right">-0.0119965</td>
<td align="left">-14.3774434209978</td>
<td align="left">0.00172479</td>
<td align="left">estimated</td>
</tr>
<tr class="even">
<td align="left">OMEGA2.2</td>
<td align="right">0.0126612</td>
<td align="left">14.04811550248</td>
<td align="left">0.00177866</td>
<td align="left">estimated</td>
</tr>
<tr class="odd">
<td align="left">OMEGA3.1</td>
<td align="right">0.0009369</td>
<td align="left">238.458434996446</td>
<td align="left">0.00223416</td>
<td align="left">estimated</td>
</tr>
<tr class="even">
<td align="left">OMEGA3.2</td>
<td align="right">0.0002040</td>
<td align="left">783.157038242474</td>
<td align="left">0.00159775</td>
<td align="left">estimated</td>
</tr>
<tr class="odd">
<td align="left">OMEGA3.3</td>
<td align="right">0.0097863</td>
<td align="left">31.5432476592301</td>
<td align="left">0.00308692</td>
<td align="left">estimated</td>
</tr>
<tr class="even">
<td align="left">OMEGA4.1</td>
<td align="right">-0.0027350</td>
<td align="left">-68.2349672031649</td>
<td align="left">0.00186624</td>
<td align="left">estimated</td>
</tr>
<tr class="odd">
<td align="left">OMEGA4.2</td>
<td align="right">0.0014773</td>
<td align="left">86.915995397008</td>
<td align="left">0.00128401</td>
<td align="left">estimated</td>
</tr>
<tr class="even">
<td align="left">OMEGA4.3</td>
<td align="right">0.0018365</td>
<td align="left">118.063957572161</td>
<td align="left">0.00216828</td>
<td align="left">estimated</td>
</tr>
<tr class="odd">
<td align="left">OMEGA4.4</td>
<td align="right">0.0095120</td>
<td align="left">20.3524593093791</td>
<td align="left">0.00193593</td>
<td align="left">estimated</td>
</tr>
<tr class="even">
<td align="left">SIGMA1.1</td>
<td align="right">1.0000000</td>
<td align="left">…..</td>
<td align="left">…..</td>
<td align="left">fixed</td>
</tr>
</tbody>
</table>
<p>Good diagnostics. Parameter estimates are precise, with Theta CV% generally &lt;15-20%.</p>
</div>
</div>
<div id="how-much-structural-model-variance-is-explained" class="section level2">
<h2 class="hasAnchor">
<a href="#how-much-structural-model-variance-is-explained" class="anchor"></a>How much structural model variance is explained?</h2>
<pre><code>## Joining, by = "Parameter"
## Joining, by = "Parameter"
## Joining, by = "Parameter"
## Joining, by = "Parameter"
## Joining, by = "Parameter"</code></pre>
<p>extraction of example1.xml complete.</p>
<pre><code>## Joining, by = "Parameter"</code></pre>
<p>extraction of example3.xml complete.</p>
<table class="table">
<thead><tr class="header">
<th align="left">Parameter</th>
<th align="right">Base</th>
<th align="right">Final</th>
<th align="right">Explained</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ETA 1</td>
<td align="right">0.1650614</td>
<td align="right">0.0412289</td>
<td align="right">0.7502209</td>
</tr>
<tr class="even">
<td align="left">ETA 2</td>
<td align="right">0.0159565</td>
<td align="right">0.0002040</td>
<td align="right">0.9872144</td>
</tr>
<tr class="odd">
<td align="left">ETA 3</td>
<td align="right">0.0139061</td>
<td align="right">0.0014773</td>
<td align="right">0.8937658</td>
</tr>
<tr class="even">
<td align="left">ETA 4</td>
<td align="right">0.1499063</td>
<td align="right">0.0095120</td>
<td align="right">0.9365469</td>
</tr>
</tbody>
</table>
</div>
<div id="covariate-effect-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#covariate-effect-plots" class="anchor"></a>Covariate Effect Plots</h2>
<p>Create equations for V1 and CL. If you add a list called “label”, the elements will be used on the y axes of plots.</p>
<p>Now get the parameter values and pack into a list. Add the ETA elements (only need two).</p>
<p>Create covariate object</p>
<p>Print the plots</p>
<pre><code>## Joining, by = "Parameter"</code></pre>
<pre><code>## extraction of example3.xml complete.</code></pre>
<ul>
<li>Shaded areas represent 95% prediction intervals around the population values (solid lines).</li>
</ul>
</div>
<div id="vpc-final-model" class="section level2">
<h2 class="hasAnchor">
<a href="#vpc-final-model" class="anchor"></a>VPC Final Model</h2>
<p>First plot is xpose (preferred) style, second is simplified style.</p>
<p><img src="RunaNONMEMAnalysis_files/figure-html/unnamed-chunk-17-1.png" width="700"><img src="RunaNONMEMAnalysis_files/figure-html/unnamed-chunk-17-2.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jason Chittenden, Klaas Prins, Lee Hodge.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
